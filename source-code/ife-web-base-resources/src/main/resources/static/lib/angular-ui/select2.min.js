angular.module("ui.select2",[]).value("uiSelect2Config",{}).directive("uiSelect2",["uiSelect2Config","$timeout","$translate",function(e,t,i){var n={};return e&&angular.extend(n,e),{require:"ngModel",priority:1,compile:function(e,l){var a,r,s,o=e.is("select"),u=angular.isDefined(l.multiple);return e.is("select")&&(r=e.find("optgroup[ng-repeat], optgroup[data-ng-repeat], option[ng-repeat], option[data-ng-repeat]")).length&&(s=r.attr("ng-repeat")||r.attr("data-ng-repeat"),a=jQuery.trim(s.split("|")[0]).split(" ").pop()),function(e,r,s,c){var g=angular.extend({},n,e.$eval(s.uiSelect2)),d=function(e){var t;return g.simple_tags?(t=[],angular.forEach(e,function(e,i){t.push(e.id)})):t=e,t},p=function(e){var t=[];return e?(g.simple_tags?(t=[],angular.forEach(e,function(e,i){t.push({id:e,text:e})})):t=e,t):t};if(o?(delete g.multiple,delete g.initSelection):u&&(g.multiple=!0),c&&(e.$watch(l.ngModel,function(e,t){e!==t&&(c.$render(),r.select2("val",c.$modelValue))},!0),c.$render=function(){if(o)r.select2("val",c.$viewValue);else if(g.multiple){c.$isEmpty=function(e){return!e||0===e.length};var e=c.$viewValue;angular.isString(e)&&(e=e.split(",")),r.select2("data",p(e)),g.sortable&&r.select2("container").find("ul.select2-choices").sortable({containment:"parent",start:function(){r.select2("onSortStart")},update:function(){r.select2("onSortEnd"),r.trigger("change")}})}else angular.isObject(c.$viewValue)?r.select2("data",c.$viewValue):c.$viewValue?r.select2("val",c.$viewValue):r.select2("data",null)},a&&e.$watch(a,function(e,i,n){angular.equals(e,i)||t(function(){r.select2("val",c.$viewValue),c.$render(),e&&!i&&c.$setPristine&&c.$setPristine(!0)})}),c.$parsers.push(function(e){return r.prev().toggleClass("ng-invalid",!c.$valid).toggleClass("ng-valid",c.$valid).toggleClass("ng-invalid-required",!c.$valid).toggleClass("ng-valid-required",c.$valid).toggleClass("ng-dirty",c.$dirty).toggleClass("ng-pristine",c.$pristine),e}),!o&&(r.bind("change",function(t){t.stopImmediatePropagation(),e.$$phase||e.$root.$$phase||e.$apply(function(){c.$setViewValue(d(r.select2("data")))})}),g.initSelection))){var $=g.initSelection;g.initSelection=function(e,t){$(e,function(e){var i=c.$pristine;c.$setViewValue(d(e)),t(e),i&&c.$setPristine(),r.prev().toggleClass("ng-pristine",c.$pristine)})}}r.bind("$destroy",function(){r.select2("destroy")}),s.$observe("disabled",function(e){r.select2("enable",!e)}),s.$observe("readonly",function(e){r.select2("readonly",!!e)}),s.ngMultiple&&e.$watch(s.ngMultiple,function(e){s.$set("multiple",!!e),r.select2(g)}),i.isReady()&&t(function(){if(r.select2(g),r.select2("data",c.$modelValue),c.$render(),!g.initSelection&&!o){var e=c.$pristine;c.$pristine=!1,c.$setViewValue(d(r.select2("data"))),e&&c.$setPristine(),r.prev().toggleClass("ng-pristine",c.$pristine)}}),i.isReady()||i.onReady(function(){t(function(){if(r.select2(g),r.select2("data",c.$modelValue),c.$render(),!g.initSelection&&!o){var e=c.$pristine;c.$pristine=!1,c.$setViewValue(d(r.select2("data"))),e&&c.$setPristine(),r.prev().toggleClass("ng-pristine",c.$pristine)}})})}}}}]);